<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>National Park Interactive Map</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background: #87CEEB;
    }
    .controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      background: rgba(0, 0, 0, 0.8);
      padding: 15px;
      border-radius: 10px;
      z-index: 1000;
    }
    .controls button {
      padding: 10px 15px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background: #4CAF50;
      color: white;
      cursor: pointer;
    }
    .toolbar {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.8);
      padding: 15px;
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 1000;
    }
    .toolbar button {
      padding: 10px 15px;
      font-size: 14px;
      border: none;
      border-radius: 5px;
      background: #2196F3;
      color: white;
      cursor: pointer;
    }
    .toolbar button.active {
      background: #FFA500;
    }
    .tooltip {
      position: fixed;
      padding: 5px 10px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      border-radius: 5px;
      pointer-events: none;
      display: none;
      z-index: 1001;
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <button id="add-tree">üå≤ Tree</button>
    <button id="add-mountain">‚õ∞Ô∏è Mountain</button>
    <button id="add-river">üíß River</button>
    <button id="add-rock">ü™® Rock</button>
    <button id="add-grass">üåø Grass</button>
    <button id="clear-tile">üóëÔ∏è Clear</button>
  </div>
  <div class="controls">
    <button id="up">‚Üë</button>
    <button id="down">‚Üì</button>
    <button id="left">‚Üê</button>
    <button id="right">‚Üí</button>
    <button id="zoom-in">+</button>
    <button id="zoom-out">-</button>
    <button id="view-full-map">üó∫Ô∏è Full Map</button>
  </div>
  <div class="tooltip"></div>

  <script type="module">
    import * as PIXI from 'https://cdn.jsdelivr.net/npm/pixi.js@7/dist/pixi.min.mjs';
    
    // Initialize PIXI Application
    const app = new PIXI.Application({
      width: window.innerWidth,
      height: window.innerHeight,
      backgroundColor: 0x87CEEB,
      antialias: true,
    });
    document.body.appendChild(app.view);

    // Create textures using graphics for better reliability
    const createTreeTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.beginFill(0x2E7D32);
      graphics.drawPolygon([25, 80, 40, 30, 55, 80]);
      graphics.endFill();
      graphics.beginFill(0x795548);
      graphics.drawRect(37, 80, 6, 20);
      graphics.endFill();
      return app.renderer.generateTexture(graphics);
    };

    const createMountainTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.beginFill(0x757575);
      graphics.drawPolygon([10, 80, 40, 20, 70, 80]);
      graphics.endFill();
      return app.renderer.generateTexture(graphics);
    };

    const createRockTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.beginFill(0x9E9E9E);
      graphics.drawEllipse(40, 50, 20, 15);
      graphics.endFill();
      return app.renderer.generateTexture(graphics);
    };

    const createRiverTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.lineStyle(4, 0x2196F3);
      graphics.moveTo(30, 20);
      graphics.bezierCurveTo(40, 40, 30, 60, 40, 80);
      return app.renderer.generateTexture(graphics);
    };

    const createGrassTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.lineStyle(2, 0x4CAF50);
      graphics.moveTo(30, 80);
      graphics.lineTo(30, 60);
      graphics.moveTo(40, 80);
      graphics.lineTo(40, 55);
      graphics.moveTo(50, 80);
      graphics.lineTo(50, 65);
      return app.renderer.generateTexture(graphics);
    };

    const textures = {
      tree: createTreeTexture(),
      mountain: createMountainTexture(),
      rock: createRockTexture(),
      river: createRiverTexture(),
      grass: createGrassTexture(),
    };

    class Tile extends PIXI.Container {
      constructor(x, y, size) {
        super();
        this.x = x * size;
        this.y = y * size;
        this.size = size;
        this.interactive = true;
        this.buttonMode = true;

        // Background
        const background = new PIXI.Graphics();
        background.beginFill(0x81C784);
        background.drawRect(0, 0, size, size);
        background.endFill();
        background.lineStyle(1, 0x000000, 0.1);
        background.drawRect(0, 0, size, size);
        this.addChild(background);

        this.currentElement = null;

        this.on('pointerover', this.onHover.bind(this));
        this.on('pointerout', this.onUnhover.bind(this));
        this.on('pointerdown', this.onClick.bind(this));
      }

      onHover() {
        this.alpha = 0.8;
      }

      onUnhover() {
        this.alpha = 1;
      }

      onClick() {
        if (!window.selectedTool) return;

        if (window.selectedTool === 'clear') {
          if (this.currentElement) {
            this.removeChild(this.currentElement);
            this.currentElement = null;
          }
        } else {
          if (this.currentElement) {
            this.removeChild(this.currentElement);
          }

          const sprite = new PIXI.Sprite(textures[window.selectedTool]);
          sprite.width = this.size * 0.8;
          sprite.height = this.size * 0.8;
          sprite.x = this.size * 0.1;
          sprite.y = this.size * 0.1;
          
          this.addChild(sprite);
          this.currentElement = sprite;
        }
      }
    }

    // Create map container
    const mapContainer = new PIXI.Container();
    app.stage.addChild(mapContainer);

    // Generate tiles
    const tileSize = 80;
    const gridWidth = 15;
    const gridHeight = 15;

    for (let y = 0; y < gridHeight; y++) {
      for (let x = 0; x < gridWidth; x++) {
        const tile = new Tile(x, y, tileSize);
        mapContainer.addChild(tile);
      }
    }

    // Center the map
    mapContainer.x = (app.screen.width - gridWidth * tileSize) / 2;
    mapContainer.y = (app.screen.height - gridHeight * tileSize) / 2;

    // Tool selection
    window.selectedTool = null;
    document.querySelectorAll('.toolbar button').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.toolbar button').forEach(b => 
          b.classList.remove('active'));
        button.classList.add('active');
        window.selectedTool = button.id.replace('add-', '').replace('clear-', 'clear');
      });
    });

    // Navigation controls
    const moveAmount = 50;
    document.getElementById('up').onclick = () => mapContainer.y += moveAmount;
    document.getElementById('down').onclick = () => mapContainer.y -= moveAmount;
    document.getElementById('left').onclick = () => mapContainer.x += moveAmount;
    document.getElementById('right').onclick = () => mapContainer.x -= moveAmount;

    let scale = 1;
    document.getElementById('zoom-in').onclick = () => {
      scale = Math.min(2, scale + 0.1);
      mapContainer.scale.set(scale);
    };
    document.getElementById('zoom-out').onclick = () => {
      scale = Math.max(0.5, scale - 0.1);
      mapContainer.scale.set(scale);
    };

    document.getElementById('view-full-map').onclick = () => {
      scale = Math.min(
        app.screen.width / (gridWidth * tileSize),
        app.screen.height / (gridHeight * tileSize)
      ) * 0.9;
      mapContainer.scale.set(scale);
      mapContainer.x = (app.screen.width - gridWidth * tileSize * scale) / 2;
      mapContainer.y = (app.screen.height - gridHeight * tileSize * scale) / 2;
    };

    // Handle window resize
    window.addEventListener('resize', () => {
      app.renderer.resize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>