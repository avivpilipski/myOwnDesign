<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>National Park Explorer</title>
  <script src="https://cdn.jsdelivr.net/npm/pixi.js@7/dist/pixi.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/index.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { 
      margin: 0; 
      overflow: hidden; 
      font-family: Arial, sans-serif; 
      background: #87CEEB; 
    }
    .tool-btn {
      padding: 10px 15px;
      background: rgba(0,0,0,0.7);
      color: white;
      border-radius: 5px;
      margin: 5px 0;
      transition: all 0.3s ease;
    }
    .tool-btn:hover {
      background: rgba(255,255,255,0.2);
    }
    .nav-btn {
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 10px 15px;
      border-radius: 5px;
      transition: all 0.3s ease;
    }
    .nav-btn:hover {
      background: rgba(255,255,255,0.2);
    }
  </style>
</head>
<body>
  <div id="welcome-container" class="fixed inset-0 z-50 bg-gradient-to-br from-green-900 to-blue-900 
    flex items-center justify-center transition-all duration-1000">
    <div class="text-center p-8 max-w-3xl">
      <h1 class="text-6xl font-bold text-green-300 mb-6 animate-pulse">
        Build Your Own National Park
      </h1>
      <p class="text-2xl text-gray-200 mb-8">
        Craft your wilderness, one tile at a time
      </p>
      <div class="space-x-8 mb-12 flex justify-center">
        <div class="text-center">
          <span class="text-4xl">🌲</span>
          <p class="text-gray-400">Trees</p>
        </div>
        <div class="text-center">
          <span class="text-4xl">⛰️</span>
          <p class="text-gray-400">Mountains</p>
        </div>
        <div class="text-center">
          <span class="text-4xl">💧</span>
          <p class="text-gray-400">Rivers</p>
        </div>
        <div class="text-center">
          <span class="text-4xl">🪨</span>
          <p class="text-gray-400">Rocks</p>
        </div>
        <div class="text-center">
          <span class="text-4xl">🐻</span>
          <p class="text-gray-400">Animals</p>
        </div>
      </div>
      <button id="start-game-btn" 
        class="px-10 py-4 bg-green-500 text-white rounded-lg text-xl 
        hover:bg-green-600 transform hover:-translate-y-1 transition-all">
        Start Exploring
      </button>
      <p class="text-sm text-gray-400 mt-4">
        Created by Aviv Pilipski
      </p>
    </div>
  </div>

  <div class="toolbar fixed top-4 left-4 z-50" style="display:none;">
    <div class="bg-black/80 p-4 rounded-lg flex flex-col gap-2">
      <button id="add-tree" class="tool-btn">🌲 Tree</button>
      <button id="add-mountain" class="tool-btn">⛰️ Mountain</button>
      <button id="add-river" class="tool-btn">💧 River</button>
      <button id="add-rock" class="tool-btn">🪨 Rock</button>
      <button id="add-grass" class="tool-btn">🌿 Grass</button>
      <button id="add-animal" class="tool-btn">🐻 Animal</button>
      <button id="clear-tile" class="tool-btn">🗑️ Clear</button>
    </div>
  </div>

  <div class="controls fixed bottom-4 left-1/2 -translate-x-1/2 z-50" style="display:none;">
    <div class="bg-black/80 p-4 rounded-lg flex gap-2">
      <button id="up" class="nav-btn">↑</button>
      <button id="down" class="nav-btn">↓</button>
      <button id="left" class="nav-btn">←</button>
      <button id="right" class="nav-btn">→</button>
      <button id="zoom-in" class="nav-btn">+</button>
      <button id="zoom-out" class="nav-btn">-</button>
      <button id="view-full-map" class="nav-btn">🗺️</button>
    </div>
  </div>

  <script type="module">
    import * as PIXI from 'https://cdn.jsdelivr.net/npm/pixi.js@7/dist/pixi.min.mjs';
    

    // Initialize PIXI Application
    const app = new PIXI.Application({
      width: window.innerWidth,
      height: window.innerHeight,
      backgroundColor: 0x87CEEB,
      antialias: true,
    });
    document.body.appendChild(app.view);

    // Create textures using graphics for better reliability
    const createTreeTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.beginFill(0x2E7D32);
      graphics.drawPolygon([25, 80, 40, 30, 55, 80]);
      graphics.endFill();
      graphics.beginFill(0x795548);
      graphics.drawRect(37, 80, 6, 20);
      graphics.endFill();
      return app.renderer.generateTexture(graphics);
    };

    const createMountainTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.beginFill(0x757575);
      graphics.drawPolygon([10, 80, 40, 20, 70, 80]);
      graphics.endFill();
      return app.renderer.generateTexture(graphics);
    };

    const createRockTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.beginFill(0x9E9E9E);
      graphics.drawEllipse(40, 50, 20, 15);
      graphics.endFill();
      return app.renderer.generateTexture(graphics);
    };

    const createRiverTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.lineStyle(4, 0x2196F3);
      graphics.moveTo(30, 20);
      graphics.bezierCurveTo(40, 40, 30, 60, 40, 80);
      return app.renderer.generateTexture(graphics);
    };

    const createGrassTexture = () => {
      const graphics = new PIXI.Graphics();
      graphics.lineStyle(2, 0x4CAF50);
      graphics.moveTo(30, 80);
      graphics.lineTo(30, 60);
      graphics.moveTo(40, 80);
      graphics.lineTo(40, 55);
      graphics.moveTo(50, 80);
      graphics.lineTo(50, 65);
      return app.renderer.generateTexture(graphics);
    };

    const textures = {
      tree: createTreeTexture(),
      mountain: createMountainTexture(),
      rock: createRockTexture(),
      river: createRiverTexture(),
      grass: createGrassTexture(),
    };

    class Tile extends PIXI.Container {
      constructor(x, y, size) {
        super();
        this.x = x * size;
        this.y = y * size;
        this.size = size;
        this.interactive = true;
        this.buttonMode = true;

        // Background
        const background = new PIXI.Graphics();
        background.beginFill(0x81C784);
        background.drawRect(0, 0, size, size);
        background.endFill();
        background.lineStyle(1, 0x000000, 0.1);
        background.drawRect(0, 0, size, size);
        this.addChild(background);

        this.currentElement = null;

        this.on('pointerover', this.onHover.bind(this));
        this.on('pointerout', this.onUnhover.bind(this));
        this.on('pointerdown', this.onClick.bind(this));
      }

      onHover() {
        this.alpha = 0.8;
      }

      onUnhover() {
        this.alpha = 1;
      }

      onClick() {
        if (!window.selectedTool) return;

        if (window.selectedTool === 'clear') {
          if (this.currentElement) {
            this.removeChild(this.currentElement);
            this.currentElement = null;
          }
        } else {
          if (this.currentElement) {
            this.removeChild(this.currentElement);
          }

          const sprite = new PIXI.Sprite(textures[window.selectedTool]);
          sprite.width = this.size * 0.8;
          sprite.height = this.size * 0.8;
          sprite.x = this.size * 0.1;
          sprite.y = this.size * 0.1;
          
          this.addChild(sprite);
          this.currentElement = sprite;
        }
      }
    }

    // Create map container
    const mapContainer = new PIXI.Container();
    app.stage.addChild(mapContainer);

    // Generate tiles
    const tileSize = 80;
    const gridWidth = 15;
    const gridHeight = 15;

    for (let y = 0; y < gridHeight; y++) {
      for (let x = 0; x < gridWidth; x++) {
        const tile = new Tile(x, y, tileSize);
        mapContainer.addChild(tile);
      }
    }

    // Center the map
    mapContainer.x = (app.screen.width - gridWidth * tileSize) / 2;
    mapContainer.y = (app.screen.height - gridHeight * tileSize) / 2;

    // Tool selection
    window.selectedTool = null;
    document.querySelectorAll('.toolbar button').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.toolbar button').forEach(b => 
          b.classList.remove('active'));
        button.classList.add('active');
        window.selectedTool = button.id.replace('add-', '').replace('clear-', 'clear');
      });
    });

    // Navigation controls
    const moveAmount = 50;
    document.getElementById('up').onclick = () => mapContainer.y += moveAmount;
    document.getElementById('down').onclick = () => mapContainer.y -= moveAmount;
    document.getElementById('left').onclick = () => mapContainer.x += moveAmount;
    document.getElementById('right').onclick = () => mapContainer.x -= moveAmount;

    let scale = 1;
    document.getElementById('zoom-in').onclick = () => {
      scale = Math.min(2, scale + 0.1);
      mapContainer.scale.set(scale);
    };
    document.getElementById('zoom-out').onclick = () => {
      scale = Math.max(0.5, scale - 0.1);
      mapContainer.scale.set(scale);
    };

    document.getElementById('view-full-map').onclick = () => {
      scale = Math.min(
        app.screen.width / (gridWidth * tileSize),
        app.screen.height / (gridHeight * tileSize)
      ) * 0.9;
      mapContainer.scale.set(scale);
      mapContainer.x = (app.screen.width - gridWidth * tileSize * scale) / 2;
      mapContainer.y = (app.screen.height - gridHeight * tileSize * scale) / 2;
    };
     // Game Initialization
     document.getElementById('start-game-btn').addEventListener('click', () => {
      document.getElementById('welcome-container').style.display = 'none';
      document.querySelector('.toolbar').style.display = 'block';
      document.querySelector('.controls').style.display = 'block';
      new NationalParkGame();
    });

    // Handle window resize
    window.addEventListener('resize', () => {
      app.renderer.resize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>